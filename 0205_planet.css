/* ---------------------------------------------------- */
/* æ˜Ÿçƒå®¹å™¨å®šä½è¨­å®š */
/* ---------------------------------------------------- */

/* ç¢ºä¿ç•«å¸ƒå……æ»¿ scene-wrapper */
#canvas-container, #label-container {
    position: absolute; 
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}

#label-container {
    z-index: 2;
    /* ğŸ‘‡ ä¿®æ­£ 3ï¼šé€™è£¡ä¸èƒ½è¨­ pointer-events: noneï¼Œå¦å‰‡ OrbitControls æœƒæŠ“ä¸åˆ°æ»‘é¼  */
    /* æˆ‘å€‘æ”¹åœ¨ HTML çµæ§‹ä¸­æ§åˆ¶ */
}

canvas {
    display: block;
    width: 100% !important;
    height: 100% !important;
    outline: none;
}

/* ---------------------------------------------------- */
/* ç¯€é»èˆ‡æ˜Ÿæ˜Ÿæ¨£å¼ (é€™éƒ¨åˆ†ä¿ç•™ä½ çš„è¨­å®š) */
/* ---------------------------------------------------- */

.work-node {
    --node-color: #BF94FF; 
    pointer-events: auto; /* æ˜Ÿæ˜Ÿæœ¬èº«å¯ä»¥é» */
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 0.4s ease;
}

.work-node.is-occluded {
    opacity: 0.15;
    pointer-events: none;
}

.star-icon {
    position: relative;
    width: 14px; height: 14px;
    background: var(--node-color);
    box-shadow: 0 0 15px var(--node-color);
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
    transition: transform 0.3s ease, background 0.3s ease;
}

.star-icon::before, .star-icon::after {
    content: ''; 
    position: absolute; 
    top: 50%; left: 50%;
    transform: translate(-50%, -50%); 
    background: var(--node-color);
    opacity: 0.6; 
}
.star-icon::before { width: 2px; height: 24px; }
.star-icon::after { width: 24px; height: 2px; }

.work-node:hover .star-icon {
    transform: scale(1.6) rotate(45deg);
    background: #ffffff;
    box-shadow: 0 0 25px var(--node-color), 0 0 50px var(--node-color);
}

.node-label-name {
    margin-top: 10px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    letter-spacing: 0.05em;
    color: var(--node-color);
    text-shadow: 0 0 8px var(--node-color);
    border: 1px solid var(--node-color);
    white-space: nowrap;
    background: rgba(0,0,0,0.7);
    padding: 4px 8px;
    border-radius: 4px;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

.node-card {
    position: absolute;
    bottom: 45px;
    width: 260px;
    padding: 1.2rem;
    background: rgba(10, 10, 10, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid var(--node-color);
    border-radius: 12px;
    color: white;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.4s ease;
    pointer-events: none;
    z-index: 10;
}

.work-node:hover .node-card {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.filter-container {
    position: absolute;       /* ç‚ºäº†è®“ä¸‹æ‹‰é¸å–®å®šä½ */
    margin-top: 24px;         /* èˆ‡ä¸Šæ–¹æ¨™é¡Œçš„è·é›¢ */
    z-index: 50;
    font-family: 'JetBrains Mono', monospace;
    pointer-events: auto;     /* é—œéµï¼å› ç‚ºçˆ¶å±¤ header æ˜¯ noneï¼Œé€™è£¡è¦é–‹å›ä¾†æ‰èƒ½é» */
    width: fit-content;       /* å¯¬åº¦éš¨å…§å®¹èª¿æ•´ */
    top: 20px;
    left: 20px;
    z-index: 50;
    margin-top: 0;
    font-family: 'JetBrains Mono', monospace;
}

/* ç¯©é¸æŒ‰éˆ• (Trigger) */
.filter-btn {
    background: rgba(10, 10, 10, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #BF94FF;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
}

.filter-btn:hover {
    background: rgba(191, 148, 255, 0.15);
    border-color: #BF94FF;
    color: white;
}

/* ä¸‹æ‹‰é¸å–® */
.filter-menu {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 8px;
    background: rgba(5, 5, 5, 0.95);
    border: 1px solid rgba(191, 148, 255, 0.3);
    border-radius: 12px;
    padding: 8px;
    width: 180px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 10px 30px -10px rgba(0,0,0,0.8);
}

/* é¸å–®å±•é–‹ç‹€æ…‹ */
.filter-container:hover .filter-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* é¸é …æŒ‰éˆ• */
.filter-option {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 11px;
    color: #888;
    transition: all 0.2s;
    border: 1px solid transparent;
}

.filter-option:hover {
    background: rgba(255, 255, 255, 0.05);
    color: white;
}

/* é¸ä¸­ç‹€æ…‹ (Active) */
.filter-option.active {
    background: rgba(191, 148, 255, 0.1);
    border-color: rgba(191, 148, 255, 0.3);
    color: white;
    font-weight: bold;
}

.filter-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: currentColor;
    box-shadow: 0 0 5px currentColor;
}

/* ---------------------------------------------------- */
/* ğŸ†• æ–°å¢ï¼šç¯©é¸äº’å‹•æ•ˆæœ */
/* ---------------------------------------------------- */

/* è¢«éæ¿¾æ‰çš„æ˜Ÿæ˜Ÿï¼šè®Šå¾—å¾ˆæš—ä¸”ä¸èƒ½é» */
.work-node.filtered-out {
    opacity: 0.05 !important; /* å¼·åˆ¶è®Šæš— */
    pointer-events: none !important;
    filter: grayscale(100%);
}

/* è¢«é¸ä¸­æ™‚çš„é–ƒçˆå‹•ç•« */
@keyframes star-flash-anim {
    0% { transform: scale(1); filter: brightness(1); }
    30% { transform: scale(2.5); filter: brightness(3); } /* ç¬é–“è®Šå¤§è®Šäº® */
    100% { transform: scale(1); filter: brightness(1); }
}

.work-node.flash-active .star-icon {
    animation: star-flash-anim 0.6s ease-out forwards;
}